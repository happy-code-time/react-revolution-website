import * as React from 'react';

import ReactDOM from 'react-dom';

import { InputFileDragDrop } from './react-revolution';

import './react-revolution/sass/rr-input-file-drag-drop.scss';
/**
 * Render it to the html while testing
 */
class App extends React.Component 
{
    constructor(props) {
        super(props);
        this.readFile = this.readFile.bind(this);
        this.errorHandler = this.errorHandler.bind(this);

        this.state = {
            label: 'labelValue',
            fileNames: []
        };
    }

    errorHandler(messageType, customData){

        switch(messageType){
            case 'empty_filename' : {
                console.error(`unrecognized_filetype ${customData ? customData : ''}`);
                break;
            }
            case 'empty_filecontent' : {
                console.error(`unrecognized_filetype ${customData ? customData : ''}`);
                break;
            }
            case 'unrecognized_filetype' : {
                console.error(`unrecognized_filetype ${customData ? customData : ''}`);
                break;
            }
            case 'maximum_filesize_reached' : {
                console.error(`Datei Größe zu groß ${customData ? customData : ''}`);
                break;
            }
            case 'unsupported_filetype' : {
                console.error(`unsupported_filetype ${customData ? customData : ''}`);
                break;
            }
            default : {
                console.error(`Unbekannter Fehler ${customData ? customData : ''}`);
                break;
            }
        }
    }

    /**
     * Switch file type
     * @param {object} file
     * @param {string} type
     */
    readFile(file, type) {
        const { fileNames } = this.state;

        switch (type) {
            case 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': {
                console.info('Reading as XSLX file type');
                break;
            }
            case 'text/csv': {
                console.info('Reading as CSV file type');
                break;
            }
            default: {
                console.error(`File type not supported: ${type}`);
            }
        }
        console.info(type);
        console.info(file);

        fileNames.push(file.name);
        this.setState({ fileNames });
    }

    render() {
        const { fileNames } = this.state;

        return (
            <span style={
                {
                    display: 'block',
                    position: 'relative',
                    width: '300px'
                }
            }>
                <InputFileDragDrop
                    placeholder='Drag Drop your files here...'
                    allowedFileSize={2}
                    sizeDescriptor={"MB"}
                    allowedFiles={['text/csv', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet']}
                    errorCallback={this.errorHandler}
                    errorCallbackCustomData={'------'}
                    readFileCallback={this.readFile}
                    multiple={true}
                />
            </span>
        )
    }
}

ReactDOM.render(<App />, document.getElementById('app'));